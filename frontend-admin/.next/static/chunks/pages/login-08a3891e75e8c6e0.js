(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return r(1632)}])},610:function(e,t,r){"use strict";r.d(t,{ax:function(){return i},kv:function(){return o},p7:function(){return s},yb:function(){return a}});let n=r(7066).Z.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let o={login:(e,t)=>n.post("/auth/login",{email:e,password:t}),getMe:()=>n.get("/auth/me")},s={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/members",{params:e})},getById:e=>n.get("/members/".concat(e)),create:e=>n.post("/members",e),update:(e,t)=>n.put("/members/".concat(e),t),delete:e=>n.delete("/members/".concat(e))},a={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions",{params:e})},getById:e=>n.get("/contributions/".concat(e)),getStats:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions/stats/summary",{params:e})},getStatsByType:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions/stats/by-type",{params:e})},getCelebrants:()=>n.get("/contributions/celebrants"),create:e=>n.post("/contributions",e),update:(e,t)=>n.put("/contributions/".concat(e),t),delete:e=>n.delete("/contributions/".concat(e))},i={monthly:(e,t)=>n.get("/reports/monthly",{params:{date_debut:e,date_fin:t},responseType:"blob"}),member:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.get("/reports/member/".concat(e),{params:t,responseType:"blob"})},event:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.get("/reports/event/".concat(e),{params:t,responseType:"blob"})},members:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/reports/members",{params:e,responseType:"blob"})},contributions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/reports/contributions",{params:e,responseType:"blob"})}}},7828:function(e,t,r){"use strict";r.d(t,{$8:function(){return a},DH:function(){return s},QV:function(){return n},v0:function(){return o}});let n=(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t))},o=()=>{{let e=localStorage.getItem("token"),t=localStorage.getItem("user");return{token:e,user:t?JSON.parse(t):null}}},s=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},a=()=>!!localStorage.getItem("token")},1632:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(5893),o=r(7294),s=r(1163),a=r(610),i=r(7828),l=r(3186),u=r.n(l);function c(){let[e,t]=(0,o.useState)(""),[r,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(""),[m,p]=(0,o.useState)(!1),g=(0,s.useRouter)();(0,o.useEffect)(()=>{(0,i.$8)()&&g.push("/dashboard")},[g]);let b=async t=>{t.preventDefault(),d(""),p(!0);try{let t=await a.kv.login(e,r);(0,i.QV)(t.data.token,t.data.user),g.push("/dashboard")}catch(e){var n,o;d((null===(o=e.response)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:n.error)||"Erreur de connexion")}finally{p(!1)}};return(0,n.jsx)("div",{className:u().container,children:(0,n.jsxs)("div",{className:u().card,children:[(0,n.jsxs)("div",{className:u().header,children:[(0,n.jsx)("h1",{className:u().title,children:"\uD83C\uDF1F Les \xc9toiles de Hor\xe8-Koubi"}),(0,n.jsx)("p",{className:u().subtitle,children:"Connexion \xe0 l'interface admin"})]}),(0,n.jsxs)("form",{onSubmit:b,className:u().form,children:[c&&(0,n.jsx)("div",{className:u().error,children:c}),(0,n.jsxs)("div",{className:u().formGroup,children:[(0,n.jsx)("label",{htmlFor:"email",children:"Email"}),(0,n.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>t(e.target.value),required:!0,placeholder:"admin@ehk.org"})]}),(0,n.jsxs)("div",{className:u().formGroup,children:[(0,n.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),(0,n.jsx)("input",{type:"password",id:"password",value:r,onChange:e=>l(e.target.value),required:!0,placeholder:"••••••••"})]}),(0,n.jsx)("button",{type:"submit",className:u().submitBtn,disabled:m,children:m?"Connexion...":"Se connecter"})]})]})})}},3186:function(e){e.exports={container:"Login_container__DPp2Z",card:"Login_card__3dJzk",header:"Login_header___Bcko",title:"Login_title__S9Xbe",subtitle:"Login_subtitle__LUyEd",form:"Login_form__F7zp_",formGroup:"Login_formGroup__vLoUr",error:"Login_error__2xYo0",submitBtn:"Login_submitBtn__Rb7Pf"}}},function(e){e.O(0,[143,888,774,179],function(){return e(e.s=6429)}),_N_E=e.O()}]);