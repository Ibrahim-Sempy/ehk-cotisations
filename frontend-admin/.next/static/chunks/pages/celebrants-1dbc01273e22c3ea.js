(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[628],{3505:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/celebrants",function(){return r(3378)}])},6153:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(5893),a=r(7294),s=r(1163),l=r(1664),o=r.n(l),c=r(4052),i=r(7828),u=r(1414),m=r.n(u);function d(e){let{children:t}=e,[r,l]=(0,a.useState)(!0),[u,d]=(0,a.useState)(null),_=(0,s.useRouter)();(0,a.useEffect)(()=>{let{user:e}=(0,i.v0)();e?d(e):_.push("/login")},[_]);let b=[{href:"/dashboard",icon:c.m6D,label:"Tableau de bord",roles:["admin","secretaire","tresorier"]},{href:"/members",icon:c.WY8,label:"Membres",roles:["admin","secretaire","tresorier"]},{href:"/contributions",icon:c.oQC,label:"Cotisations",roles:["admin","secretaire","tresorier"]},{href:"/celebrants",icon:c.jRj,label:"Par C\xe9l\xe9brant",roles:["admin","secretaire","tresorier"]},{href:"/reports",icon:c.NOg,label:"Rapports",roles:["admin","secretaire","tresorier"]}].filter(e=>u&&e.roles.includes(u.role));return u?(0,n.jsxs)("div",{className:m().container,children:[(0,n.jsxs)("aside",{className:"".concat(m().sidebar," ").concat(r?m().sidebarOpen:m().sidebarClosed),children:[(0,n.jsxs)("div",{className:m().sidebarHeader,children:[(0,n.jsx)("h2",{className:m().logo,children:"\uD83C\uDF1F EHK"}),(0,n.jsx)("button",{className:m().toggleBtn,onClick:()=>l(!r),children:r?(0,n.jsx)(c.q5L,{}):(0,n.jsx)(c.cur,{})})]}),(0,n.jsx)("nav",{className:m().nav,children:b.map(e=>{let t=e.icon,a=_.pathname===e.href||_.pathname.startsWith(e.href+"/");return(0,n.jsxs)(o(),{href:e.href,className:"".concat(m().navItem," ").concat(a?m().navItemActive:""),children:[(0,n.jsx)(t,{className:m().navIcon}),r&&(0,n.jsx)("span",{children:e.label})]},e.href)})}),(0,n.jsxs)("div",{className:m().sidebarFooter,children:[(0,n.jsx)("div",{className:m().userInfo,children:r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:m().userName,children:u.email}),(0,n.jsx)("p",{className:m().userRole,children:u.role})]})}),(0,n.jsxs)("button",{className:m().logoutBtn,onClick:()=>{(0,i.DH)(),_.push("/login")},children:[(0,n.jsx)(c.xqh,{}),r&&(0,n.jsx)("span",{children:"D\xe9connexion"})]})]})]}),(0,n.jsx)("main",{className:m().main,children:t})]}):null}},610:function(e,t,r){"use strict";r.d(t,{ax:function(){return o},kv:function(){return a},p7:function(){return s},yb:function(){return l}});let n=r(7066).Z.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let a={login:(e,t)=>n.post("/auth/login",{email:e,password:t}),getMe:()=>n.get("/auth/me")},s={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/members",{params:e})},getById:e=>n.get("/members/".concat(e)),create:e=>n.post("/members",e),update:(e,t)=>n.put("/members/".concat(e),t),delete:e=>n.delete("/members/".concat(e))},l={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions",{params:e})},getById:e=>n.get("/contributions/".concat(e)),getStats:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions/stats/summary",{params:e})},getStatsByType:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/contributions/stats/by-type",{params:e})},getCelebrants:()=>n.get("/contributions/celebrants"),create:e=>n.post("/contributions",e),update:(e,t)=>n.put("/contributions/".concat(e),t),delete:e=>n.delete("/contributions/".concat(e))},o={monthly:(e,t)=>n.get("/reports/monthly",{params:{date_debut:e,date_fin:t},responseType:"blob"}),member:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.get("/reports/member/".concat(e),{params:t,responseType:"blob"})},event:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.get("/reports/event/".concat(e),{params:t,responseType:"blob"})},members:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/reports/members",{params:e,responseType:"blob"})},contributions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.get("/reports/contributions",{params:e,responseType:"blob"})}}},7828:function(e,t,r){"use strict";r.d(t,{$8:function(){return l},DH:function(){return s},QV:function(){return n},v0:function(){return a}});let n=(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t))},a=()=>{{let e=localStorage.getItem("token"),t=localStorage.getItem("user");return{token:e,user:t?JSON.parse(t):null}}},s=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},l=()=>!!localStorage.getItem("token")},3378:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(5893),a=r(7294),s=r(6153),l=r(4001),o=r.n(l);function c(e){let{message:t,type:r="success",onClose:s,duration:l=3e3}=e;return(0,a.useEffect)(()=>{if(l>0){let e=setTimeout(()=>{s()},l);return()=>clearTimeout(e)}},[l,s]),(0,n.jsx)("div",{className:"".concat(o().toast," ").concat(o()[r]),children:(0,n.jsxs)("div",{className:o().content,children:[(0,n.jsx)("span",{className:o().message,children:t}),(0,n.jsx)("button",{className:o().closeBtn,onClick:s,"aria-label":"Fermer",children:"\xd7"})]})})}var i=r(610),u=r(9834),m=r.n(u);function d(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(""),[o,u]=(0,a.useState)([]),[d,_]=(0,a.useState)([]),[b,h]=(0,a.useState)(!0),[p,g]=(0,a.useState)(!1),[v,x]=(0,a.useState)(null),[j,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{y()},[]);let y=async()=>{try{h(!0);let e=await i.yb.getCelebrants();t(e.data),x(null)}catch(e){x("Erreur lors de la r\xe9cup\xe9ration des c\xe9l\xe9brants"),console.error(e)}finally{h(!1)}},N=async e=>{try{g(!0),l(e),u([]),_([]),x(null);let t=(await i.yb.getAll({celebrant:e})).data,r=(await i.p7.getAll()).data,n={};r.forEach(e=>{n[e.id]=e});let a=new Set,s={};t.forEach(e=>{a.has(e.membre_id)||(a.add(e.membre_id),n[e.membre_id]?s[e.membre_id]=n[e.membre_id]:s[e.membre_id]={id:e.membre_id,nom_complet:e.membre_nom||"Membre inconnu",telephone:e.membre_telephone,statut:"actif"})}),u(t),_(Object.values(s)),t.length>0&&f({message:"".concat(t.length," cotisation(s) trouv\xe9e(s) pour ").concat(Object.keys(s).length," membre(s)"),type:"success"})}catch(e){x("Erreur lors de la r\xe9cup\xe9ration des donn\xe9es"),console.error(e)}finally{g(!1)}},C=e=>{try{let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear();return"".concat(r,"/").concat(n,"/").concat(a)}catch(t){return e}},S=e=>new Intl.NumberFormat("fr-FR").format(e),I=e=>({mensuelle:"Mensuelle",bapteme:"Bapt\xeame",mariage:"Mariage",cas_particulier:"Cas particulier"})[e]||e,T=e=>({paye:"Pay\xe9",non_paye:"Non pay\xe9",partiel:"Partiel"})[e]||e,B=e=>({paye:"#22c55e",non_paye:"#ef4444",partiel:"#f59e0b"})[e]||"#6b7280";return(0,n.jsxs)(s.Z,{children:[j&&(0,n.jsx)(c,{message:j.message,type:j.type,onClose:()=>f(null)}),(0,n.jsxs)("div",{className:m().container,children:[(0,n.jsxs)("div",{className:m().header,children:[(0,n.jsx)("h1",{children:"Membres par C\xe9l\xe9brant"}),(0,n.jsx)("p",{children:"S\xe9lectionnez un c\xe9l\xe9brant pour voir les membres ayant cotis\xe9 avec lui"})]}),v&&(0,n.jsx)("div",{className:m().error,children:v}),(0,n.jsxs)("div",{className:m().selector,children:[(0,n.jsx)("label",{htmlFor:"celebrant-select",children:"S\xe9lectionner un c\xe9l\xe9brant :"}),b?(0,n.jsx)("div",{className:m().loading,children:"Chargement des c\xe9l\xe9brants..."}):0===e.length?(0,n.jsx)("div",{className:m().empty,children:"Aucun c\xe9l\xe9brant trouv\xe9"}):(0,n.jsxs)("select",{id:"celebrant-select",value:r,onChange:e=>{e.target.value?N(e.target.value):(l(""),u([]),_([]))},className:m().select,children:[(0,n.jsx)("option",{value:"",children:"-- S\xe9lectionner un c\xe9l\xe9brant --"}),e.map((e,t)=>(0,n.jsx)("option",{value:e,children:e},t))]})]}),r&&(0,n.jsx)("div",{className:m().content,children:p?(0,n.jsx)("div",{className:m().loading,children:"Chargement des donn\xe9es..."}):0===d.length?(0,n.jsx)("div",{className:m().empty,children:"Aucun membre trouv\xe9 pour ce c\xe9l\xe9brant"}):(0,n.jsx)("div",{className:m().tableContainer,children:(0,n.jsxs)("table",{className:m().table,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Membre"}),(0,n.jsx)("th",{children:"T\xe9l\xe9phone"}),(0,n.jsx)("th",{children:"Type"}),(0,n.jsx)("th",{children:"Date"}),(0,n.jsx)("th",{children:"Montant"}),(0,n.jsx)("th",{children:"Statut"}),(0,n.jsx)("th",{children:"Observation"})]})}),(0,n.jsx)("tbody",{children:o.map(e=>{var t;let r=d.find(t=>t.id===e.membre_id);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:m().memberCell,children:(0,n.jsxs)("div",{className:m().memberInfo,children:[(0,n.jsx)("div",{className:m().memberAvatar,children:(null==r?void 0:null===(t=r.nom_complet)||void 0===t?void 0:t.charAt(0).toUpperCase())||"?"}),(0,n.jsx)("span",{className:m().memberName,children:(null==r?void 0:r.nom_complet)||e.membre_nom||"Membre inconnu"})]})}),(0,n.jsx)("td",{children:(null==r?void 0:r.telephone)||e.membre_telephone||"-"}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:m().typeBadge,children:I(e.type)})}),(0,n.jsx)("td",{children:C(e.date)}),(0,n.jsxs)("td",{className:m().amountCell,children:[S(e.montant)," GNF"]}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:m().statutBadge,style:{backgroundColor:B(e.statut)+"20",color:B(e.statut)},children:T(e.statut)})}),(0,n.jsx)("td",{className:m().observationCell,children:e.observation||"-"})]},e.id)})})]})})}),!r&&(0,n.jsxs)("div",{className:m().placeholder,children:[(0,n.jsx)("div",{className:m().placeholderIcon,children:"\uD83D\uDC64"}),(0,n.jsx)("p",{children:"S\xe9lectionnez un c\xe9l\xe9brant pour voir les membres"})]})]})]})}},9834:function(e){e.exports={container:"Celebrants_container__4Y9ke",header:"Celebrants_header__d0ek_",error:"Celebrants_error__HH9RH",selector:"Celebrants_selector__KiWem",select:"Celebrants_select__9_8zG",loading:"Celebrants_loading__6QMMC",empty:"Celebrants_empty__Yhw7_",content:"Celebrants_content__PYxRC",tableContainer:"Celebrants_tableContainer__qjD5D",table:"Celebrants_table__YzLlh",memberCell:"Celebrants_memberCell__S0F2B",memberInfo:"Celebrants_memberInfo__fNUqw",memberAvatar:"Celebrants_memberAvatar__T47HF",memberName:"Celebrants_memberName__Qy4gR",amountCell:"Celebrants_amountCell__qWBZO",typeBadge:"Celebrants_typeBadge__9Hqbo",statutBadge:"Celebrants_statutBadge__BBDQB",observationCell:"Celebrants_observationCell__pf2lK",placeholder:"Celebrants_placeholder__NQ7nx",placeholderIcon:"Celebrants_placeholderIcon__laq0i"}},1414:function(e){e.exports={container:"Layout_container__l2gjk",sidebar:"Layout_sidebar__saart",sidebarOpen:"Layout_sidebarOpen__THWCw",sidebarClosed:"Layout_sidebarClosed__PuE9D",sidebarHeader:"Layout_sidebarHeader__yeRXA",logo:"Layout_logo__Yfd0y",toggleBtn:"Layout_toggleBtn__wFcRT",nav:"Layout_nav__qOLUE",navItem:"Layout_navItem__dRAc_",navItemActive:"Layout_navItemActive__qGqMp",navIcon:"Layout_navIcon__g1cHI",sidebarFooter:"Layout_sidebarFooter__QOc3J",userInfo:"Layout_userInfo__m2y6A",userName:"Layout_userName__Jcd4T",userRole:"Layout_userRole__xkSlq",logoutBtn:"Layout_logoutBtn___va_g",main:"Layout_main__BqQ1G"}},4001:function(e){e.exports={toast:"Toast_toast__Jg6J0",slideIn:"Toast_slideIn__JQHMq",content:"Toast_content__TpS73",success:"Toast_success__KNV1s",error:"Toast_error__GDxRb",info:"Toast_info__ykZRS",message:"Toast_message__Q8S92",closeBtn:"Toast_closeBtn__PDEbr"}}},function(e){e.O(0,[152,143,612,888,774,179],function(){return e(e.s=3505)}),_N_E=e.O()}]);