(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(8170)}])},6153:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var s=a(5893),r=a(7294),o=a(1163),n=a(1664),l=a.n(n),i=a(4052),c=a(7828),d=a(1414),u=a.n(d);function m(e){let{children:t}=e,[a,n]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null),_=(0,o.useRouter)();(0,r.useEffect)(()=>{let{user:e}=(0,c.v0)();e?m(e):_.push("/login")},[_]);let h=[{href:"/dashboard",icon:i.m6D,label:"Tableau de bord",roles:["admin","secretaire","tresorier"]},{href:"/members",icon:i.WY8,label:"Membres",roles:["admin","secretaire","tresorier"]},{href:"/contributions",icon:i.oQC,label:"Cotisations",roles:["admin","secretaire","tresorier"]},{href:"/celebrants",icon:i.jRj,label:"Par C\xe9l\xe9brant",roles:["admin","secretaire","tresorier"]},{href:"/reports",icon:i.NOg,label:"Rapports",roles:["admin","secretaire","tresorier"]}].filter(e=>d&&e.roles.includes(d.role));return d?(0,s.jsxs)("div",{className:u().container,children:[(0,s.jsxs)("aside",{className:"".concat(u().sidebar," ").concat(a?u().sidebarOpen:u().sidebarClosed),children:[(0,s.jsxs)("div",{className:u().sidebarHeader,children:[(0,s.jsx)("h2",{className:u().logo,children:"\uD83C\uDF1F EHK"}),(0,s.jsx)("button",{className:u().toggleBtn,onClick:()=>n(!a),children:a?(0,s.jsx)(i.q5L,{}):(0,s.jsx)(i.cur,{})})]}),(0,s.jsx)("nav",{className:u().nav,children:h.map(e=>{let t=e.icon,r=_.pathname===e.href||_.pathname.startsWith(e.href+"/");return(0,s.jsxs)(l(),{href:e.href,className:"".concat(u().navItem," ").concat(r?u().navItemActive:""),children:[(0,s.jsx)(t,{className:u().navIcon}),a&&(0,s.jsx)("span",{children:e.label})]},e.href)})}),(0,s.jsxs)("div",{className:u().sidebarFooter,children:[(0,s.jsx)("div",{className:u().userInfo,children:a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:u().userName,children:d.email}),(0,s.jsx)("p",{className:u().userRole,children:d.role})]})}),(0,s.jsxs)("button",{className:u().logoutBtn,onClick:()=>{(0,c.DH)(),_.push("/login")},children:[(0,s.jsx)(i.xqh,{}),a&&(0,s.jsx)("span",{children:"D\xe9connexion"})]})]})]}),(0,s.jsx)("main",{className:u().main,children:t})]}):null}},610:function(e,t,a){"use strict";a.d(t,{ax:function(){return l},kv:function(){return r},p7:function(){return o},yb:function(){return n}});let s=a(7066).Z.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});let r={login:(e,t)=>s.post("/auth/login",{email:e,password:t}),getMe:()=>s.get("/auth/me")},o={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/members",{params:e})},getById:e=>s.get("/members/".concat(e)),create:e=>s.post("/members",e),update:(e,t)=>s.put("/members/".concat(e),t),delete:e=>s.delete("/members/".concat(e))},n={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/contributions",{params:e})},getById:e=>s.get("/contributions/".concat(e)),getStats:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/contributions/stats/summary",{params:e})},getStatsByType:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/contributions/stats/by-type",{params:e})},getCelebrants:()=>s.get("/contributions/celebrants"),create:e=>s.post("/contributions",e),update:(e,t)=>s.put("/contributions/".concat(e),t),delete:e=>s.delete("/contributions/".concat(e))},l={monthly:(e,t)=>s.get("/reports/monthly",{params:{date_debut:e,date_fin:t},responseType:"blob"}),member:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.get("/reports/member/".concat(e),{params:t,responseType:"blob"})},event:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.get("/reports/event/".concat(e),{params:t,responseType:"blob"})},members:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/reports/members",{params:e,responseType:"blob"})},contributions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.get("/reports/contributions",{params:e,responseType:"blob"})}}},7828:function(e,t,a){"use strict";a.d(t,{$8:function(){return n},DH:function(){return o},QV:function(){return s},v0:function(){return r}});let s=(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t))},r=()=>{{let e=localStorage.getItem("token"),t=localStorage.getItem("user");return{token:e,user:t?JSON.parse(t):null}}},o=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},n=()=>!!localStorage.getItem("token")},8170:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(5893),r=a(7294),o=a(6153),n=a(610),l=a(307),i=a(4052),c=a(569),d=a.n(c);function u(){let[e,t]=(0,r.useState)({total:0,total_paye:0,total_non_paye:0,total_partiel:0}),[a,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[_,h]=(0,r.useState)("year");(0,r.useEffect)(()=>{p()},[_]);let p=async()=>{try{m(!0);let e=y(_),a=(0,l.Z)(new Date,"yyyy-MM-dd");console.log("Loading stats - Period:",_,"Date d\xe9but:",e,"Date fin:",a);let[s,r]=await Promise.all([n.yb.getStats({date_debut:e,date_fin:a}),n.yb.getStatsByType({date_debut:e,date_fin:a})]);console.log("Stats response:",s.data),console.log("Stats by type response:",r.data);let o=s.data||{};t({total:Number(o.total)||0,total_paye:Number(o.total_paye)||0,total_non_paye:Number(o.total_non_paye)||0,total_partiel:Number(o.total_partiel)||0}),c(r.data||[])}catch(t){var e;console.error("Error loading stats:",t),console.error("Error details:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{m(!1)}},y=e=>{let t=new Date;switch(e){case"month":default:return(0,l.Z)(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd");case"year":let a=t.getFullYear();if(0===t.getMonth())return(0,l.Z)(new Date(a-1,0,1),"yyyy-MM-dd");return(0,l.Z)(new Date(a,0,1),"yyyy-MM-dd")}},b=[{title:"Total Cotisations",value:e.total||0,icon:i.oQC,color:"#3b82f6",suffix:""},{title:"Total Pay\xe9",value:e.total_paye||0,icon:i.QqI,color:"#10b981",suffix:" GNF"},{title:"Total Non Pay\xe9",value:e.total_non_paye||0,icon:i.bcx,color:"#ef4444",suffix:" GNF"},{title:"Total Partiel",value:e.total_partiel||0,icon:i.WY8,color:"#f59e0b",suffix:" GNF"}];return(0,s.jsx)(o.Z,{children:(0,s.jsxs)("div",{className:d().container,children:[(0,s.jsxs)("div",{className:d().header,children:[(0,s.jsx)("h1",{className:d().title,children:"Tableau de bord"}),(0,s.jsxs)("select",{value:_,onChange:e=>h(e.target.value),className:d().periodSelect,children:[(0,s.jsx)("option",{value:"month",children:"Ce mois"}),(0,s.jsx)("option",{value:"year",children:"Cette ann\xe9e"})]})]}),u?(0,s.jsx)("div",{className:d().loading,children:"Chargement..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:d().statsGrid,children:b.map((e,t)=>{let a=e.icon;return(0,s.jsxs)("div",{className:d().statCard,children:[(0,s.jsx)("div",{className:d().statCardHeader,children:(0,s.jsx)("div",{className:d().statIcon,style:{backgroundColor:"".concat(e.color,"20"),color:e.color},children:(0,s.jsx)(a,{})})}),(0,s.jsxs)("div",{className:d().statCardBody,children:[(0,s.jsxs)("p",{className:d().statValue,children:[e.value.toLocaleString(),e.suffix]}),(0,s.jsx)("p",{className:d().statTitle,children:e.title})]})]},t)})}),(0,s.jsx)("div",{className:d().summary,children:(0,s.jsxs)("div",{className:d().summaryCard,children:[(0,s.jsx)("h3",{children:"R\xe9sum\xe9"}),(0,s.jsxs)("div",{className:d().summaryContent,children:[(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsx)("span",{children:"Taux de paiement:"}),(0,s.jsxs)("strong",{children:[e.total>0?(e.total_paye/(e.total_paye+e.total_non_paye)*100).toFixed(1):0,"%"]})]}),(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsx)("span",{children:"Montant restant:"}),(0,s.jsxs)("strong",{children:[(e.total_non_paye+e.total_partiel).toLocaleString()," GNF"]})]})]})]})}),a.length>0&&(0,s.jsxs)("div",{className:d().summaryCard,children:[(0,s.jsx)("h3",{children:"Total par type"}),(0,s.jsx)("div",{className:d().typeStatsGrid,children:a.map((e,t)=>(0,s.jsxs)("div",{className:d().typeStatCard,children:[(0,s.jsxs)("div",{className:d().typeStatHeader,children:[(0,s.jsx)("strong",{children:{mensuelle:"Mensuelle",bapteme:"Bapt\xeame",mariage:"Mariage",cas_particulier:"Cas part."}[e.type]||e.type}),(0,s.jsx)("span",{className:d().typeStatCount,children:e.count})]}),(0,s.jsxs)("div",{className:d().typeStatBody,children:[(0,s.jsxs)("div",{className:d().typeStatRow,children:[(0,s.jsx)("span",{children:"Total:"}),(0,s.jsx)("strong",{children:e.total.toLocaleString()})]}),(0,s.jsxs)("div",{className:d().typeStatRow,children:[(0,s.jsx)("span",{children:"Pay\xe9:"}),(0,s.jsx)("span",{style:{color:"#10b981"},children:e.total_paye.toLocaleString()})]}),(0,s.jsxs)("div",{className:d().typeStatRow,children:[(0,s.jsx)("span",{children:"Non pay\xe9:"}),(0,s.jsx)("span",{style:{color:"#ef4444"},children:e.total_non_paye.toLocaleString()})]})]})]},t))})]})]})]})})}},569:function(e){e.exports={container:"Dashboard_container__NIhIv",header:"Dashboard_header__Zvu6_",title:"Dashboard_title__cl9_F",periodSelect:"Dashboard_periodSelect__H1KvM",loading:"Dashboard_loading__5pNHT",statsGrid:"Dashboard_statsGrid__M2NKc",statCard:"Dashboard_statCard__iSr46",statCardHeader:"Dashboard_statCardHeader__jXVvn",statIcon:"Dashboard_statIcon__QInSN",statCardBody:"Dashboard_statCardBody__1KfWh",statValue:"Dashboard_statValue__7AKBu",statTitle:"Dashboard_statTitle__7cYeL",summary:"Dashboard_summary__8NhPq",summaryCard:"Dashboard_summaryCard__temdl",summaryContent:"Dashboard_summaryContent__ZfbUU",summaryItem:"Dashboard_summaryItem__jCs0V",typeStatsGrid:"Dashboard_typeStatsGrid__uDod0",typeStatCard:"Dashboard_typeStatCard__PgC58",typeStatHeader:"Dashboard_typeStatHeader__XbeMH",typeStatCount:"Dashboard_typeStatCount__SLaKL",typeStatBody:"Dashboard_typeStatBody___0dq1",typeStatRow:"Dashboard_typeStatRow__XB_g3"}},1414:function(e){e.exports={container:"Layout_container__l2gjk",sidebar:"Layout_sidebar__saart",sidebarOpen:"Layout_sidebarOpen__THWCw",sidebarClosed:"Layout_sidebarClosed__PuE9D",sidebarHeader:"Layout_sidebarHeader__yeRXA",logo:"Layout_logo__Yfd0y",toggleBtn:"Layout_toggleBtn__wFcRT",nav:"Layout_nav__qOLUE",navItem:"Layout_navItem__dRAc_",navItemActive:"Layout_navItemActive__qGqMp",navIcon:"Layout_navIcon__g1cHI",sidebarFooter:"Layout_sidebarFooter__QOc3J",userInfo:"Layout_userInfo__m2y6A",userName:"Layout_userName__Jcd4T",userRole:"Layout_userRole__xkSlq",logoutBtn:"Layout_logoutBtn___va_g",main:"Layout_main__BqQ1G"}}},function(e){e.O(0,[152,143,612,307,888,774,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);